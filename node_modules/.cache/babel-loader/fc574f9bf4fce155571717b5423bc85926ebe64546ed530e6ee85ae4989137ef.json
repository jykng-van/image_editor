{"ast":null,"code":"export default class ImageEditor{//presented on canvas image info\nconstructor(canvas,message_callback){//the canvas object\n//2nd context of the canvas\n//the image being modified\n//non-zoom ratio of the image based on sizing to meet the max dimension\n//the zoom ratio of the image\n//the zoom ratio of the image based on width\n//the zoom ratio of the image based on height\nthis.max_zoom=4.0;//zoom level\nthis.min_dimension=64;//minimum dimension of the image, for cropping and what's permitted\nthis.max_dimension=1920;//the mouse action mode\nthis.rotate_angle=90;//callback for external message function\nthis.image_types=['image/jpeg','image/png','image/webp','image/gif','image/bmp'];//y coordinates when first clicked\nthis.mouse_engaged=false;//is the mouse down\n//cropping stuff\nthis.crop={x:null,y:null,width:null,height:null,start_x:null,start_y:null};//the which cropping editing method to be used\nthis.handle_radius=4;//radius of the crop handles\nthis.current_image={x:null,y:null,width:null,height:null,start_x:null,start_y:null};//possible max width 2056\nconsole.log('ImageEditor constructor!');this.canvas=canvas;console.log(canvas);this.ctx=this.canvas.getContext('2d');this.img=new Image();this.img.crossOrigin='Anonymous';this.message_callback=message_callback;this.mode='move';this.rotating=false;//mouse actions on canvas\nthis.canvas.addEventListener('mousedown',this.mouse_down.bind(this));window.addEventListener('mouseup',this.mouse_up.bind(this));this.canvas.addEventListener('mousemove',this.mouse_move.bind(this));//zoom buttons\nthis.zoom=1.0;window.addEventListener('resize',()=>{//redraw on window resize, such as opening and closing the dev console\nconsole.log('resize');if(this.canvas.offsetParent!==null&&this.img.src){this.canvas.removeAttribute('width');this.canvas.removeAttribute('height');this.load_image(null,true);}});this.img.addEventListener('load',this.load_image.bind(this));//important to run when image is done loading, otherwise no dimensions\nconsole.log(this.canvas.width,this.canvas.height);}set_img_src(src){this.img.src=src;}load_image(e){let keep_crop=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;console.log('load_image',e);console.log(devicePixelRatio);if(this.rotating){//if rotating keep crop and zoom level\nkeep_crop=true;this.rotating=false;}try{this.mime_type=this.img.src.substring(this.img.src.indexOf(':')+1,this.img.src.indexOf(';'));console.log('mime_type',this.mime_type);this.canvas.width=this.canvas.offsetWidth;this.canvas.height=this.canvas.offsetHeight;let cwidth=this.canvas.width;let cheight=this.canvas.height;let iwidth=this.img.width;let iheight=this.img.height;let is_wide=iwidth>iheight;console.log('is_wide',is_wide,iwidth,iheight);if(iwidth<this.min_dimension||iheight<this.min_dimension){//minimum size check\nthrow new Error(\"Image doesn't meet minimum size\");}//get adjusted ratio to keep image within max\nif(iwidth>this.max_dimension&&is_wide){console.log('reduce width');this.adjusted_ratio=this.max_dimension/iwidth;}else if(iheight>this.max_dimension){console.log('reduce height');this.adjusted_ratio=this.max_dimension/iheight;}else{this.adjusted_ratio=1.0;}console.log('keep_crop',keep_crop);if(!keep_crop){this.crop={x:0,y:0,width:iwidth,height:iheight,start_x:null,start_y:null};}this.width_ratio=iwidth*this.adjusted_ratio/cwidth;this.height_ratio=iheight*this.adjusted_ratio/cheight;console.log('cwidth',cwidth,'cheight',cheight,'adjusted_ratio',this.adjusted_ratio,'width_ratio',this.width_ratio,'height_ratio',this.height_ratio,'iwidth/width_ratio',iwidth/this.width_ratio,'iheight/width_ratio',iheight/this.width_ratio,'iwidth/height_ratio',iwidth/this.height_ratio,'iheight/height_ratio',iheight/this.height_ratio);//fill height or fill width\nif(iwidth*this.adjusted_ratio>cwidth||iheight*this.adjusted_ratio>cheight){//try to fit into canvas\nif(iwidth*this.adjusted_ratio/this.height_ratio>cwidth){//fit wide because the height is larger than the canvas\nthis.ratio=this.width_ratio;}else{//fit high\nthis.ratio=this.height_ratio;}this.fit_zoom=this.adjusted_ratio/this.ratio;}else{this.fit_zoom=this.adjusted_ratio;this.ratio=this.width_ratio;}//check for zoom levels, based on keep crop or not\nif(!keep_crop){this.zoom=this.fit_zoom;}else{this.zoom=Math.max(this.fit_zoom,this.zoom);}console.log('ratio',this.ratio);console.log('zoom',this.zoom);console.log('crop',this.crop);let current=this.current_image;current.width=iwidth*this.zoom;current.height=iheight*this.zoom;current.x=(cwidth-current.width)/2;current.y=(cheight-current.height)/2;console.log('current',current);this.set_mode(this.mode);}catch(ex){this.message_callback(ex.message);}}//Draw the scale image on the canvas\ndraw_image(){console.log('draw_image');this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);//clear image\nlet src={x:0,y:0,width:this.img.width,height:this.img.height};let current=this.current_image;console.log('src.x',src.x,'src.y',src.y,'src.width',src.width,'src.height',src.height,//get all of source images\n'current.x',current.x,'current.y',current.y,'current.width',current.width,'current.height',current.height);//draw whole image at lower opacity\nthis.ctx.globalAlpha=0.5;this.ctx.drawImage(this.img,src.x,src.y,src.width,src.height,//get all of source images\ncurrent.x,current.y,current.width,current.height);//then draw cropped area at full opacity\nthis.ctx.globalAlpha=1;src=(_ref=>{let{x,y,width,height}=_ref;return{x,y,width,height};})(this.crop);console.log('src.x',src.x,'src.y',src.y,'src.width',src.width,'src.height',src.height);this.ctx.drawImage(this.img,src.x,src.y,src.width,src.height,//get all of source images\nthis.current_image.x+this.crop.x*this.zoom,this.current_image.y+this.crop.y*this.zoom,this.crop.width*this.zoom,this.crop.height*this.zoom);}draw_cropper(){let ctx=this.ctx;let cropbox=this.cropbox;console.log(cropbox);ctx.lineWidth=1;ctx.strokeStyle='#0095DA88';ctx.fillStyle='#0095DA88';//main rectangle\nctx.beginPath();ctx.rect(cropbox.x,cropbox.y,cropbox.width,cropbox.height);let width3rd=cropbox.width*.33;ctx.moveTo(cropbox.x+width3rd,cropbox.y);ctx.lineTo(cropbox.x+width3rd,cropbox.y+cropbox.height);ctx.moveTo(cropbox.x+width3rd*2,cropbox.y);ctx.lineTo(cropbox.x+width3rd*2,cropbox.y+cropbox.height);let height3rd=cropbox.height*.33;ctx.moveTo(cropbox.x,cropbox.y+height3rd);ctx.lineTo(cropbox.x+cropbox.width,cropbox.y+height3rd);ctx.moveTo(cropbox.x,cropbox.y+height3rd*2);ctx.lineTo(cropbox.x+cropbox.width,cropbox.y+height3rd*2);ctx.stroke();ctx.closePath();//corner circles\nlet positions=[{x:cropbox.x,y:cropbox.y},{x:cropbox.x+cropbox.width,y:cropbox.y},{x:cropbox.x,y:cropbox.y+cropbox.height},{x:cropbox.x+cropbox.width,y:cropbox.y+cropbox.height}];positions.forEach(p=>{ctx.beginPath();ctx.arc(p.x,p.y,this.handle_radius,0,2*Math.PI,false);ctx.fill();ctx.closePath();});}set_mode(mode){console.log('set_mode',mode);this.mode=mode;if(mode==='move'){this.set_view_mode();}else if(mode==='crop'){this.set_crop_mode();}}set_view_mode(){this.canvas.style.cursor='move';this.draw_image();}set_crop_mode(){this.canvas.style.cursor='default';this.draw_image();this.draw_cropper();}mouse_down(e){this.mouse_engaged=true;this.start_x=e.offsetX;this.start_y=e.offsetY;if(this.mode==='move'){console.log(this.current);this.current_image.start_x=this.current_image.x;this.current_image.start_y=this.current_image.y;}else if(this.mode==='crop'){this.crop.start_x=this.cropbox.x;this.crop.start_y=this.cropbox.y;if(this.crop_state==='default'){this.current_image.start_x=this.current_image.x;this.current_image.start_y=this.current_image.y;}console.log(this.crop);}}mouse_up(){this.mouse_engaged=false;}mouse_move(e){let current_x=e.offsetX;let current_y=e.offsetY;let change_x=current_x-this.start_x;let change_y=current_y-this.start_y;let current=this.current_image;if(this.mouse_engaged){console.log(change_x,change_y);if(this.mode==='move'){//move image\n//bounds check\nlet x_pos=current.start_x+change_x;let y_pos=current.start_y+change_y;current.x=this.check_x_bounds(x_pos);current.y=this.check_y_bounds(y_pos);this.draw_image();}else if(this.mode==='crop'){let x_pos=this.cropbox.x,y_pos=this.cropbox.y;let crop_width=this.cropbox.width;let crop_height=this.cropbox.height;console.log(this.cropbox);let cropright=this.cropbox.x+this.cropbox.width;let cropbottom=this.cropbox.y+this.cropbox.height;let left_resize=()=>{if(current_x<current.x)x_pos=current.x;//don't grow beyond left edge\nelse if(current_x>cropright-this.min_dimension/this.ratio)x_pos=cropright-this.min_dimension/this.ratio;//don't shrink smaller than minimum\nelse x_pos=current_x;crop_width=cropright-x_pos;};let right_resize=()=>{if(current_x<current.x+current.width//don't grow beyond the right edge\n&&current_x>this.cropbox.x+this.min_dimension/this.ratio)//don't shrink smaller than the minimum\ncrop_width=current_x-this.cropbox.x;};let top_resize=()=>{if(current_y<current.y)y_pos=current.y;//don't grow beyond the top edge\nelse if(current_y>cropbottom-this.min_dimension/this.ratio)y_pos=cropbottom-this.minheight/this.ratio;//don't shrink smaller than minimum\nelse y_pos=current_y;crop_height=cropbottom-y_pos;};let bottom_resize=()=>{if(current_y<current.y+current.height//don't grow beyond the bottom edge\n&&current_y>this.cropbox.y+this.min_dimension/this.ratio)//don't shrink smaller than the minimum\ncrop_height=current_y-this.cropbox.y;};switch(this.crop_state){case'nw-resize':top_resize();left_resize();break;case'ne-resize':top_resize();right_resize();break;case'sw-resize':bottom_resize();left_resize();break;case'se-resize':bottom_resize();right_resize();break;case'w-resize':left_resize();break;case'e-resize':right_resize();break;case'n-resize':top_resize();break;case's-resize':bottom_resize();break;case'move':x_pos=this.crop.start_x+change_x;y_pos=this.crop.start_y+change_y;if(x_pos<current.x){//leftside\nx_pos=current.x;}else if(x_pos+crop_width>current.x+current.width){//rightside\nx_pos=current.x+current.width-crop_width;}if(y_pos<current.y){//topside\ny_pos=current.y;}else if(y_pos+crop_height>current.y+current.height){//bottomside\ny_pos=current.y+current.height-crop_height;}break;default:current.x=this.check_x_bounds(current.start_x+change_x);current.y=this.check_y_bounds(current.start_y+change_y);x_pos=current.x+this.crop.x*this.zoom;y_pos=current.y+this.crop.y*this.zoom;}this.crop.x=(x_pos-current.x)/this.zoom;this.crop.y=(y_pos-current.y)/this.zoom;this.crop.width=crop_width/this.zoom;this.crop.height=crop_height/this.zoom;console.log(this.crop);this.draw_image();this.draw_cropper();}}else{let cropbox=this.cropbox;let rightedge=cropbox.x+cropbox.width;let bottomedge=cropbox.y+cropbox.height;if(this.mode==='crop'){if(current_x>=cropbox.x-this.handle_radius&&current_x<=cropbox.x+this.handle_radius&&current_y>=cropbox.y-this.handle_radius&&current_y<=cropbox.y+this.handle_radius){//upper left\nthis.crop_state='nw-resize';}else if(current_x>=rightedge-this.handle_radius&&current_x<=rightedge+this.handle_radius&&current_y>=cropbox.y-this.handle_radius&&current_y<=cropbox.y+this.handle_radius){//upper right\nthis.crop_state='ne-resize';}else if(current_x>=cropbox.x-this.handle_radius&&current_x<=cropbox.x+this.handle_radius&&current_y>=bottomedge-this.handle_radius&&current_y<=bottomedge+this.handle_radius){//lower left\nthis.crop_state='sw-resize';}else if(current_x>=rightedge-this.handle_radius&&current_x<=rightedge+this.handle_radius&&current_y>=bottomedge-this.handle_radius&&current_y<=bottomedge+this.handle_radius){//lower right\nthis.crop_state='se-resize';}else if(current_x>=cropbox.x-this.handle_radius&&current_x<=cropbox.x+this.handle_radius&&current_y>cropbox.y+this.handle_radius&&current_y<bottomedge-this.handle_radius){//left edge\nthis.crop_state='w-resize';}else if(current_x>=rightedge-this.handle_radius&&current_x<=rightedge+this.handle_radius&&current_y>cropbox.y+this.handle_radius&&current_y<bottomedge-this.handle_radius){//right edge\nthis.crop_state='e-resize';}else if(current_y>=cropbox.y-this.handle_radius&&current_y<=cropbox.y+this.handle_radius&&current_x>cropbox.x+this.handle_radius&&current_x<rightedge-this.handle_radius){//top edge\nthis.crop_state='n-resize';}else if(current_y>=bottomedge-this.handle_radius&&current_y<=bottomedge+this.handle_radius&&current_x>cropbox.x+this.handle_radius&&current_x<rightedge-this.handle_radius){//top edge\nthis.crop_state='s-resize';}else if(current_x>cropbox.x+this.handle_radius&&current_x<rightedge-this.handle_radius&&current_y>cropbox.y+this.handle_radius&&current_y<bottomedge-this.handle_radius){//inside\nthis.crop_state='move';}else{//outside\nthis.crop_state='default';}this.canvas.style.cursor=this.crop_state;}}}check_x_bounds(x_pos){let current=this.current_image;if(current.width<=this.canvas.width){//image is smaller than canvas\nif(x_pos<0){//leftside\nx_pos=0;}else if(x_pos+current.width>this.canvas.width){//rightside\nx_pos=this.canvas.width-current.width;}}else{//image is larger than canvas\nif(x_pos+current.width<this.canvas.width){x_pos=this.canvas.width-current.width;//leftside\n}else if(x_pos>0){x_pos=0;//rightside\n}}return x_pos;}check_y_bounds(y_pos){let current=this.current_image;if(current.height<=this.canvas.height){//image is smaller than canvas\nif(y_pos<0){//topside\ny_pos=0;}else if(y_pos+current.height>this.canvas.height){//bottomside\ny_pos=this.canvas.height-current.height;}}else{//image is larger than canvas\nif(y_pos+current.height<this.canvas.height){y_pos=this.canvas.height-current.height;//topside\n}else if(y_pos>0){y_pos=0;//bottomside\n}}return y_pos;}zoom_in(){this.scale(2.0);}zoom_out(){this.scale(.5);}scale(scale){let current=this.current_image;let center_x=this.canvas.width/2;let center_y=this.canvas.height/2;let is_wide=this.img.width>this.img.height;console.log('is_wide',is_wide);let new_zoom=this.zoom*scale;if(scale<1.0&&new_zoom<this.fit_zoom){console.log('zoom out too small');new_zoom=this.fit_zoom;}new_zoom=Math.min(this.max_zoom,new_zoom);console.log('new_zoom',new_zoom);scale=new_zoom/this.zoom;console.log('scale',scale);let x_diff=current.x-center_x;let y_diff=current.y-center_y;//adjust width\ncurrent.width=current.width*scale;current.height=current.height*scale;//adjust x and y which gets shifted\nlet x_pos=center_x+x_diff*scale;let y_pos=center_y+y_diff*scale;current.x=this.check_x_bounds(x_pos);current.y=this.check_y_bounds(y_pos);console.log(scale,x_diff,y_diff,current.x,current.y);this.ratio=this.width_ratio=this.img.width/current.width;this.height_ratio=this.img.height/current.height;this.zoom=new_zoom;console.log('zoom',this.zoom);this.draw_image();if(this.mode==='crop'){this.draw_cropper();}}rotate_image(deg){let img=this.img;let angle=deg*Math.PI/180;console.log('angle',angle);let ncanvas=document.createElement('canvas');//temporary canvas to overwrite canvas\nncanvas.width=img.height;ncanvas.height=img.width;console.log(ncanvas.width,ncanvas.height);//rotate crop area\nif(deg===90){[this.crop.x,this.crop.y]=[this.img.height-this.crop.y-this.crop.height,this.crop.x];}else if(deg===-90){[this.crop.x,this.crop.y]=[this.crop.y,this.img.width-this.crop.x-this.crop.width];}[this.crop.width,this.crop.height]=[this.crop.height,this.crop.width];console.log('new crop',this.crop);let ctx=ncanvas.getContext('2d');//rotating from center\nctx.translate(ncanvas.width/2,ncanvas.height/2);ctx.rotate(angle);ctx.translate(-ncanvas.width/2,-ncanvas.height/2);ctx.drawImage(img,0,0,img.width,img.height,(ncanvas.width-img.width)/2,-(ncanvas.width-img.width)/2,img.width,img.height);console.log((ncanvas.width-img.width)/2,-(ncanvas.width-img.width)/2,img.width,img.height);let img_url=ncanvas.toDataURL(this.mime_type);this.rotating=true;//to keep crop\nthis.img.src=img_url;//set new image data\n}save_image(){//create new canvas\nlet ncanvas=document.createElement('canvas');let crop=this.crop;ncanvas.width=crop.width*this.adjusted_ratio;ncanvas.height=crop.height*this.adjusted_ratio;let ctx=ncanvas.getContext('2d');ctx.drawImage(this.img,crop.x,crop.y,crop.width,crop.height,0,0,ncanvas.width,ncanvas.height);console.log('save as',this.mime_type);let img_url=ncanvas.toDataURL(this.mime_type);return img_url;}invalid_file(){this.message_callback('Only JPEGs, PNGs, GIFs, BMPs, or WebP allowed');}get cropbox(){let current=this.current_image;return{x:current.x+this.crop.x*this.zoom,y:current.y+this.crop.y*this.zoom,width:this.crop.width*this.zoom,height:this.crop.height*this.zoom};}}","map":{"version":3,"names":["ImageEditor","constructor","canvas","message_callback","max_zoom","min_dimension","max_dimension","rotate_angle","image_types","mouse_engaged","crop","x","y","width","height","start_x","start_y","handle_radius","current_image","console","log","ctx","getContext","img","Image","crossOrigin","mode","rotating","addEventListener","mouse_down","bind","window","mouse_up","mouse_move","zoom","offsetParent","src","removeAttribute","load_image","set_img_src","e","keep_crop","arguments","length","undefined","devicePixelRatio","mime_type","substring","indexOf","offsetWidth","offsetHeight","cwidth","cheight","iwidth","iheight","is_wide","Error","adjusted_ratio","width_ratio","height_ratio","ratio","fit_zoom","Math","max","current","set_mode","ex","message","draw_image","clearRect","globalAlpha","drawImage","_ref","draw_cropper","cropbox","lineWidth","strokeStyle","fillStyle","beginPath","rect","width3rd","moveTo","lineTo","height3rd","stroke","closePath","positions","forEach","p","arc","PI","fill","set_view_mode","set_crop_mode","style","cursor","offsetX","offsetY","crop_state","current_x","current_y","change_x","change_y","x_pos","y_pos","check_x_bounds","check_y_bounds","crop_width","crop_height","cropright","cropbottom","left_resize","right_resize","top_resize","minheight","bottom_resize","rightedge","bottomedge","zoom_in","scale","zoom_out","center_x","center_y","new_zoom","min","x_diff","y_diff","rotate_image","deg","angle","ncanvas","document","createElement","translate","rotate","img_url","toDataURL","save_image","invalid_file"],"sources":["C:/Users/Jason/projects/project_showcase/image_editor/src/ImageEditor.js"],"sourcesContent":["export default class ImageEditor{\r\n    canvas; //the canvas object\r\n    ctx; //2nd context of the canvas\r\n    img; //the image being modified\r\n    mime_type;\r\n\r\n    adjusted_ratio; //non-zoom ratio of the image based on sizing to meet the max dimension\r\n    ratio; //the zoom ratio of the image\r\n    width_ratio; //the zoom ratio of the image based on width\r\n    height_ratio; //the zoom ratio of the image based on height\r\n    max_zoom = 4.0; //the maximum zoom level\r\n    fit_zoom; //fit zoom level\r\n    zoom; //zoom level\r\n\r\n    min_dimension = 64; //minimum dimension of the image, for cropping and what's permitted\r\n    max_dimension = 1920; //maximum dimension of the image, which will resize if too big\r\n    mode; //the mouse action mode\r\n    rotate_angle = 90; //angle of rotation\r\n    rotating; //if the image is being rotated (to signal to img load event handler)\r\n\r\n    message_callback; //callback for external message function\r\n\r\n    image_types = ['image/jpeg','image/png','image/webp','image/gif','image/bmp']; //acceptable mimetypes for images\r\n\r\n    //mouse stuff\r\n    start_x; //x coordinates when first clicked\r\n    start_y; //y coordinates when first clicked\r\n    mouse_engaged = false; //is the mouse down\r\n\r\n    //cropping stuff\r\n    crop = {x:null, y:null, width:null, height:null, start_x:null, start_y:null}; //info on the crop\r\n    crop_state; //the which cropping editing method to be used\r\n    handle_radius = 4; //radius of the crop handles\r\n    current_image = {\r\n        x:null, y:null,\r\n        width:null, height:null,\r\n        start_x:null, start_y:null\r\n    }; //presented on canvas image info\r\n\r\n    constructor(canvas, message_callback){\r\n        //possible max width 2056\r\n        console.log('ImageEditor constructor!');\r\n\r\n        this.canvas = canvas;\r\n        console.log(canvas);\r\n        this.ctx = this.canvas.getContext('2d');\r\n        this.img = new Image();\r\n        this.img.crossOrigin = 'Anonymous';\r\n\r\n        this.message_callback = message_callback;\r\n        this.mode = 'move';\r\n        this.rotating = false;\r\n\r\n        //mouse actions on canvas\r\n        this.canvas.addEventListener('mousedown',this.mouse_down.bind(this));\r\n        window.addEventListener('mouseup',this.mouse_up.bind(this));\r\n        this.canvas.addEventListener('mousemove',this.mouse_move.bind(this));\r\n\r\n        //zoom buttons\r\n        this.zoom = 1.0;\r\n\r\n        window.addEventListener('resize', ()=>{ //redraw on window resize, such as opening and closing the dev console\r\n            console.log('resize');\r\n            if (this.canvas.offsetParent !== null && this.img.src){\r\n                this.canvas.removeAttribute('width');\r\n                this.canvas.removeAttribute('height');\r\n                this.load_image(null, true);\r\n            }\r\n        });\r\n        this.img.addEventListener('load', this.load_image.bind(this)); //important to run when image is done loading, otherwise no dimensions\r\n        console.log(this.canvas.width, this.canvas.height);\r\n    }\r\n    set_img_src(src){\r\n        this.img.src = src;\r\n    }\r\n    load_image(e, keep_crop=false){\r\n        console.log('load_image', e);\r\n        console.log(devicePixelRatio);\r\n        if (this.rotating){ //if rotating keep crop and zoom level\r\n            keep_crop = true;\r\n            this.rotating = false;\r\n        }\r\n\r\n        try{\r\n            this.mime_type = this.img.src.substring(this.img.src.indexOf(':')+1, this.img.src.indexOf(';'));\r\n            console.log('mime_type', this.mime_type);\r\n\r\n            this.canvas.width = this.canvas.offsetWidth;\r\n            this.canvas.height = this.canvas.offsetHeight;\r\n\r\n            let cwidth = this.canvas.width;\r\n            let cheight = this.canvas.height;\r\n\r\n            let iwidth = this.img.width;\r\n            let iheight = this.img.height;\r\n\r\n            let is_wide = iwidth > iheight;\r\n            console.log('is_wide', is_wide, iwidth, iheight);\r\n            if (iwidth < this.min_dimension || iheight < this.min_dimension){ //minimum size check\r\n                throw new Error(\"Image doesn't meet minimum size\");\r\n            }\r\n\r\n            //get adjusted ratio to keep image within max\r\n            if (iwidth > this.max_dimension && is_wide){\r\n                console.log('reduce width');\r\n                this.adjusted_ratio = this.max_dimension / iwidth;\r\n            }else if (iheight > this.max_dimension){\r\n                console.log('reduce height');\r\n                this.adjusted_ratio = this.max_dimension  / iheight;\r\n            }else{\r\n                this.adjusted_ratio = 1.0;\r\n            }\r\n            console.log('keep_crop', keep_crop);\r\n            if (!keep_crop){\r\n                this.crop = {\r\n                    x:0, y:0,\r\n                    width:iwidth, height:iheight,\r\n                    start_x:null, start_y:null\r\n                };\r\n            }\r\n\r\n            this.width_ratio = (iwidth * this.adjusted_ratio) / cwidth;\r\n            this.height_ratio = (iheight * this.adjusted_ratio) / cheight;\r\n\r\n            console.log('cwidth', cwidth, 'cheight', cheight, 'adjusted_ratio', this.adjusted_ratio,\r\n            'width_ratio', this.width_ratio, 'height_ratio', this.height_ratio,\r\n            'iwidth/width_ratio', iwidth/this.width_ratio, 'iheight/width_ratio',iheight/this.width_ratio,\r\n            'iwidth/height_ratio', iwidth/this.height_ratio, 'iheight/height_ratio', iheight/this.height_ratio);\r\n            //fill height or fill width\r\n            if (iwidth * this.adjusted_ratio > cwidth || iheight * this.adjusted_ratio > cheight){ //try to fit into canvas\r\n                if (iwidth*this.adjusted_ratio/this.height_ratio > cwidth){//fit wide because the height is larger than the canvas\r\n                    this.ratio = this.width_ratio;\r\n                }else{//fit high\r\n                    this.ratio = this.height_ratio;\r\n                }\r\n                this.fit_zoom = this.adjusted_ratio/this.ratio;\r\n            }else{\r\n                this.fit_zoom = this.adjusted_ratio;\r\n                this.ratio = this.width_ratio;\r\n            }\r\n            //check for zoom levels, based on keep crop or not\r\n            if (!keep_crop){\r\n                this.zoom = this.fit_zoom;\r\n            }else{\r\n                this.zoom = Math.max(this.fit_zoom, this.zoom);\r\n            }\r\n            console.log('ratio', this.ratio);\r\n            console.log('zoom', this.zoom);\r\n            console.log('crop', this.crop);\r\n\r\n            let current = this.current_image;\r\n            current.width = iwidth * this.zoom;\r\n            current.height = iheight * this.zoom;\r\n\r\n            current.x = (cwidth - current.width)/2;\r\n            current.y = (cheight - current.height)/2;\r\n\r\n            console.log('current', current);\r\n            this.set_mode(this.mode);\r\n        }catch(ex){\r\n            this.message_callback(ex.message);\r\n        }\r\n\r\n    }\r\n    //Draw the scale image on the canvas\r\n    draw_image(){\r\n        console.log('draw_image');\r\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height); //clear image\r\n\r\n        let src = {x:0,y:0, width:this.img.width, height:this.img.height};\r\n        let current = this.current_image;\r\n        console.log('src.x', src.x, 'src.y', src.y, 'src.width', src.width, 'src.height', src.height, //get all of source images\r\n        'current.x', current.x, 'current.y', current.y, 'current.width', current.width, 'current.height', current.height);\r\n\r\n        //draw whole image at lower opacity\r\n        this.ctx.globalAlpha = 0.5;\r\n        this.ctx.drawImage(this.img,\r\n            src.x, src.y, src.width, src.height, //get all of source images\r\n            current.x, current.y,\r\n            current.width, current.height);\r\n        //then draw cropped area at full opacity\r\n        this.ctx.globalAlpha = 1;\r\n        src = (({x,y,width,height})=>({x,y,width,height}))(this.crop);\r\n        console.log('src.x', src.x, 'src.y', src.y, 'src.width', src.width, 'src.height', src.height);\r\n        this.ctx.drawImage(this.img,\r\n            src.x, src.y, src.width, src.height, //get all of source images\r\n            this.current_image.x+this.crop.x*this.zoom,\r\n            this.current_image.y+this.crop.y*this.zoom,\r\n            this.crop.width*this.zoom,\r\n            this.crop.height*this.zoom);\r\n    }\r\n\r\n    draw_cropper(){\r\n        let ctx = this.ctx;\r\n        let cropbox = this.cropbox;\r\n        console.log(cropbox);\r\n\r\n        ctx.lineWidth = 1;\r\n        ctx.strokeStyle = '#0095DA88';\r\n        ctx.fillStyle = '#0095DA88';\r\n\r\n        //main rectangle\r\n        ctx.beginPath();\r\n        ctx.rect(cropbox.x, cropbox.y, cropbox.width, cropbox.height);\r\n        let width3rd = cropbox.width*.33;\r\n        ctx.moveTo(cropbox.x + width3rd, cropbox.y);\r\n        ctx.lineTo(cropbox.x + width3rd, cropbox.y+cropbox.height);\r\n        ctx.moveTo(cropbox.x + width3rd*2, cropbox.y);\r\n        ctx.lineTo(cropbox.x + width3rd*2, cropbox.y+cropbox.height);\r\n        let height3rd = cropbox.height*.33;\r\n        ctx.moveTo(cropbox.x, cropbox.y + height3rd);\r\n        ctx.lineTo(cropbox.x + cropbox.width, cropbox.y + height3rd);\r\n        ctx.moveTo(cropbox.x, cropbox.y + height3rd*2);\r\n        ctx.lineTo(cropbox.x + cropbox.width, cropbox.y + height3rd*2);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        //corner circles\r\n        let positions = [{x:cropbox.x, y:cropbox.y},{x:cropbox.x+cropbox.width, y:cropbox.y},\r\n            {x:cropbox.x, y:cropbox.y+cropbox.height},{x:cropbox.x+cropbox.width, y:cropbox.y+cropbox.height}];\r\n        positions.forEach(p=>{\r\n            ctx.beginPath();\r\n            ctx.arc(p.x, p.y, this.handle_radius, 0, 2 * Math.PI, false);\r\n            ctx.fill();\r\n            ctx.closePath();\r\n        });\r\n    }\r\n    set_mode(mode){\r\n        console.log('set_mode', mode);\r\n        this.mode = mode;\r\n\r\n        if(mode==='move'){\r\n            this.set_view_mode();\r\n        }else if (mode==='crop'){\r\n            this.set_crop_mode();\r\n        }\r\n    }\r\n    set_view_mode(){\r\n        this.canvas.style.cursor = 'move';\r\n        this.draw_image();\r\n    }\r\n    set_crop_mode(){\r\n        this.canvas.style.cursor = 'default';\r\n        this.draw_image();\r\n        this.draw_cropper();\r\n    }\r\n    mouse_down(e){\r\n        this.mouse_engaged  = true;\r\n        this.start_x = e.offsetX;\r\n        this.start_y = e.offsetY;\r\n        if (this.mode==='move'){\r\n            console.log(this.current);\r\n            this.current_image.start_x = this.current_image.x;\r\n            this.current_image.start_y = this.current_image.y;\r\n        }else if (this.mode==='crop'){\r\n            this.crop.start_x = this.cropbox.x;\r\n            this.crop.start_y = this.cropbox.y;\r\n            if (this.crop_state==='default'){\r\n                this.current_image.start_x = this.current_image.x;\r\n                this.current_image.start_y = this.current_image.y;\r\n            }\r\n            console.log(this.crop);\r\n        }\r\n    }\r\n    mouse_up(){\r\n        this.mouse_engaged = false;\r\n    }\r\n    mouse_move(e){\r\n        let current_x = e.offsetX;\r\n        let current_y = e.offsetY;\r\n        let change_x = current_x - this.start_x;\r\n        let change_y = current_y - this.start_y;\r\n        let current = this.current_image;\r\n        if (this.mouse_engaged){\r\n            console.log(change_x, change_y);\r\n\r\n            if(this.mode==='move'){ //move image\r\n                //bounds check\r\n                let x_pos = current.start_x+change_x;\r\n                let y_pos = current.start_y+change_y;\r\n\r\n                current.x = this.check_x_bounds(x_pos);\r\n                current.y = this.check_y_bounds(y_pos);\r\n                this.draw_image();\r\n            }else if (this.mode==='crop'){\r\n                let x_pos = this.cropbox.x, y_pos = this.cropbox.y;\r\n                let crop_width = this.cropbox.width;\r\n                let crop_height = this.cropbox.height;\r\n                console.log(this.cropbox);\r\n                let cropright = this.cropbox.x+this.cropbox.width;\r\n                let cropbottom = this.cropbox.y+this.cropbox.height;\r\n\r\n                let left_resize = ()=>{\r\n                    if (current_x < current.x) x_pos=current.x; //don't grow beyond left edge\r\n                    else if (current_x > cropright - this.min_dimension/this.ratio) x_pos=cropright-this.min_dimension/this.ratio; //don't shrink smaller than minimum\r\n                    else x_pos = current_x;\r\n\r\n                    crop_width = cropright - x_pos;\r\n                };\r\n                let right_resize = ()=>{\r\n                    if (current_x < current.x+current.width  //don't grow beyond the right edge\r\n                    && current_x > this.cropbox.x + this.min_dimension/this.ratio) //don't shrink smaller than the minimum\r\n                        crop_width = current_x - this.cropbox.x;\r\n                };\r\n                let top_resize = ()=>{\r\n                    if (current_y < current.y) y_pos=current.y; //don't grow beyond the top edge\r\n                    else if (current_y > cropbottom - this.min_dimension/this.ratio) y_pos=cropbottom-this.minheight/this.ratio; //don't shrink smaller than minimum\r\n                    else y_pos = current_y;\r\n\r\n                    crop_height = cropbottom - y_pos;\r\n                }\r\n                let bottom_resize = ()=>{\r\n                    if (current_y < current.y+current.height //don't grow beyond the bottom edge\r\n                    && current_y > this.cropbox.y + this.min_dimension/this.ratio) //don't shrink smaller than the minimum\r\n                        crop_height = current_y - this.cropbox.y;\r\n                }\r\n                switch(this.crop_state){\r\n                    case 'nw-resize':\r\n                        top_resize();\r\n                        left_resize();\r\n                        break;\r\n                    case 'ne-resize':\r\n                        top_resize();\r\n                        right_resize();\r\n                        break;\r\n                    case 'sw-resize':\r\n                        bottom_resize();\r\n                        left_resize();\r\n                        break;\r\n                    case 'se-resize':\r\n                        bottom_resize();\r\n                        right_resize();\r\n                        break;\r\n                    case 'w-resize':\r\n                        left_resize();\r\n                        break;\r\n                    case 'e-resize':\r\n                        right_resize();\r\n                        break;\r\n                    case 'n-resize':\r\n                        top_resize();\r\n                        break;\r\n                    case 's-resize':\r\n                        bottom_resize();\r\n                        break;\r\n                    case 'move':\r\n                        x_pos = this.crop.start_x+change_x;\r\n                        y_pos = this.crop.start_y+change_y;\r\n\r\n                        if (x_pos < current.x){ //leftside\r\n                            x_pos = current.x;\r\n                        }else if (x_pos + crop_width > current.x + current.width){//rightside\r\n                            x_pos = current.x + current.width - crop_width;\r\n                        }\r\n                        if (y_pos < current.y){ //topside\r\n                            y_pos = current.y;\r\n                        }else if (y_pos + crop_height > current.y + current.height){//bottomside\r\n                            y_pos = current.y + current.height - crop_height;\r\n                        }\r\n                        break;\r\n                    default:\r\n\r\n                        current.x = this.check_x_bounds(current.start_x+change_x);\r\n                        current.y = this.check_y_bounds(current.start_y+change_y);\r\n                        x_pos = current.x + this.crop.x*this.zoom;\r\n                        y_pos = current.y + this.crop.y*this.zoom;\r\n                }\r\n\r\n                this.crop.x = (x_pos - current.x)/this.zoom;\r\n                this.crop.y = (y_pos - current.y)/this.zoom;\r\n                this.crop.width = crop_width/this.zoom;\r\n                this.crop.height = crop_height/this.zoom;\r\n                console.log(this.crop);\r\n                this.draw_image();\r\n                this.draw_cropper();\r\n            }\r\n        }else{\r\n            let cropbox = this.cropbox;\r\n            let rightedge = cropbox.x + cropbox.width;\r\n            let bottomedge = cropbox.y + cropbox.height;\r\n            if (this.mode==='crop'){\r\n                if (current_x >= cropbox.x-this.handle_radius && current_x <= cropbox.x+this.handle_radius &&\r\n                current_y >= cropbox.y-this.handle_radius && current_y <= cropbox.y+this.handle_radius){ //upper left\r\n                    this.crop_state = 'nw-resize';\r\n                }else if (current_x >= rightedge-this.handle_radius && current_x <= rightedge+this.handle_radius &&\r\n                current_y >= cropbox.y-this.handle_radius && current_y <= cropbox.y+this.handle_radius){ //upper right\r\n                    this.crop_state = 'ne-resize';\r\n                }else if (current_x >= cropbox.x-this.handle_radius && current_x <= cropbox.x+this.handle_radius &&\r\n                current_y >= bottomedge-this.handle_radius && current_y <= bottomedge+this.handle_radius){ //lower left\r\n                    this.crop_state = 'sw-resize';\r\n                }else if (current_x >= rightedge-this.handle_radius && current_x <= rightedge+this.handle_radius &&\r\n                current_y >= bottomedge-this.handle_radius && current_y <= bottomedge+this.handle_radius){ //lower right\r\n                    this.crop_state = 'se-resize';\r\n                }else if (current_x >= cropbox.x-this.handle_radius && current_x <= cropbox.x+this.handle_radius &&\r\n                current_y > cropbox.y+this.handle_radius && current_y < bottomedge-this.handle_radius){ //left edge\r\n                    this.crop_state = 'w-resize';\r\n                }else if (current_x >= rightedge-this.handle_radius && current_x <= rightedge+this.handle_radius &&\r\n                current_y > cropbox.y+this.handle_radius && current_y < bottomedge-this.handle_radius){ //right edge\r\n                    this.crop_state = 'e-resize';\r\n                }else if (current_y >= cropbox.y-this.handle_radius && current_y <= cropbox.y+this.handle_radius &&\r\n                current_x > cropbox.x+this.handle_radius && current_x < rightedge-this.handle_radius){ //top edge\r\n                    this.crop_state = 'n-resize';\r\n                }else if (current_y >= bottomedge-this.handle_radius && current_y <= bottomedge+this.handle_radius &&\r\n                current_x > cropbox.x+this.handle_radius && current_x < rightedge-this.handle_radius){ //top edge\r\n                    this.crop_state = 's-resize';\r\n                }else if (current_x > cropbox.x+this.handle_radius && current_x < rightedge-this.handle_radius &&\r\n                current_y > cropbox.y+this.handle_radius && current_y < bottomedge-this.handle_radius){ //inside\r\n                    this.crop_state = 'move';\r\n                } else{ //outside\r\n                    this.crop_state = 'default';\r\n                }\r\n                this.canvas.style.cursor = this.crop_state;\r\n\r\n            }\r\n        }\r\n    }\r\n    check_x_bounds(x_pos){\r\n        let current = this.current_image;\r\n        if (current.width <= this.canvas.width){ //image is smaller than canvas\r\n            if (x_pos < 0){ //leftside\r\n                x_pos = 0;\r\n            }else if (x_pos + current.width > this.canvas.width){//rightside\r\n                x_pos = this.canvas.width - current.width;\r\n            }\r\n        }else{ //image is larger than canvas\r\n            if (x_pos + current.width < this.canvas.width){\r\n                x_pos = this.canvas.width - current.width; //leftside\r\n            }else if (x_pos > 0){\r\n                x_pos = 0; //rightside\r\n            }\r\n        }\r\n        return x_pos;\r\n    }\r\n    check_y_bounds(y_pos){\r\n        let current = this.current_image;\r\n        if (current.height <= this.canvas.height){ //image is smaller than canvas\r\n            if (y_pos < 0){ //topside\r\n                y_pos = 0;\r\n            }else if (y_pos + current.height > this.canvas.height){//bottomside\r\n                y_pos = this.canvas.height - current.height;\r\n            }\r\n        }else{ //image is larger than canvas\r\n            if (y_pos + current.height < this.canvas.height){\r\n                y_pos = this.canvas.height - current.height; //topside\r\n            }else if (y_pos > 0){\r\n                y_pos = 0; //bottomside\r\n            }\r\n        }\r\n        return y_pos;\r\n    }\r\n    zoom_in(){\r\n        this.scale(2.0);\r\n    }\r\n    zoom_out(){\r\n        this.scale(.5);\r\n    }\r\n    scale(scale){\r\n        let current = this.current_image;\r\n        let center_x = this.canvas.width / 2;\r\n        let center_y = this.canvas.height / 2;\r\n\r\n        let is_wide = this.img.width > this.img.height;\r\n        console.log('is_wide',is_wide);\r\n        let new_zoom = this.zoom * scale;\r\n        if (scale<1.0 && new_zoom < this.fit_zoom){\r\n            console.log('zoom out too small');\r\n            new_zoom = this.fit_zoom;\r\n        }\r\n        new_zoom = Math.min(this.max_zoom, new_zoom);\r\n        console.log('new_zoom',new_zoom);\r\n        scale = new_zoom / this.zoom;\r\n        console.log('scale',scale);\r\n\r\n        let x_diff = current.x - center_x;\r\n        let y_diff = current.y - center_y;\r\n\r\n        //adjust width\r\n        current.width = current.width * scale;\r\n        current.height = current.height * scale;\r\n\r\n        //adjust x and y which gets shifted\r\n        let x_pos = center_x + x_diff * scale;\r\n        let y_pos = center_y + y_diff * scale;\r\n\r\n\r\n        current.x = this.check_x_bounds(x_pos);\r\n        current.y = this.check_y_bounds(y_pos);\r\n        console.log(scale, x_diff, y_diff, current.x, current.y);\r\n        this.ratio = this.width_ratio = this.img.width / current.width;\r\n        this.height_ratio = this.img.height / current.height;\r\n\r\n        this.zoom = new_zoom;\r\n\r\n        console.log('zoom', this.zoom);\r\n        this.draw_image();\r\n        if (this.mode==='crop'){\r\n            this.draw_cropper();\r\n        }\r\n    }\r\n    rotate_image(deg){\r\n        let img = this.img;\r\n        let angle = deg*Math.PI/180;\r\n        console.log('angle',angle);\r\n\r\n        let ncanvas = document.createElement('canvas'); //temporary canvas to overwrite canvas\r\n        ncanvas.width = img.height;\r\n        ncanvas.height = img.width;\r\n\r\n        console.log(ncanvas.width, ncanvas.height);\r\n\r\n        //rotate crop area\r\n        if (deg === 90){\r\n            [this.crop.x, this.crop.y] = [this.img.height-this.crop.y-this.crop.height, this.crop.x];\r\n        }else if (deg === -90){\r\n            [this.crop.x, this.crop.y] = [this.crop.y, this.img.width-this.crop.x-this.crop.width];\r\n        }\r\n        [this.crop.width, this.crop.height] = [this.crop.height, this.crop.width];\r\n        console.log('new crop', this.crop);\r\n\r\n        let ctx = ncanvas.getContext('2d');\r\n\r\n        //rotating from center\r\n        ctx.translate(ncanvas.width/2, ncanvas.height/2);\r\n        ctx.rotate(angle);\r\n        ctx.translate(-ncanvas.width/2, -ncanvas.height/2);\r\n        ctx.drawImage(img, 0,0,\r\n            img.width,img.height,\r\n            (ncanvas.width-img.width)/2, -(ncanvas.width-img.width)/2,\r\n            img.width, img.height);\r\n        console.log((ncanvas.width-img.width)/2, -(ncanvas.width-img.width)/2,\r\n        img.width, img.height);\r\n        let img_url = ncanvas.toDataURL(this.mime_type);\r\n        this.rotating = true; //to keep crop\r\n        this.img.src = img_url; //set new image data\r\n    }\r\n\r\n    save_image(){\r\n        //create new canvas\r\n        let ncanvas = document.createElement('canvas');\r\n        let crop = this.crop;\r\n        ncanvas.width = crop.width * this.adjusted_ratio;\r\n        ncanvas.height = crop.height * this.adjusted_ratio;\r\n        let ctx = ncanvas.getContext('2d');\r\n        ctx.drawImage(this.img, crop.x, crop.y, crop.width, crop.height,\r\n            0, 0, ncanvas.width, ncanvas.height);\r\n        console.log('save as', this.mime_type);\r\n        let img_url = ncanvas.toDataURL(this.mime_type);\r\n        return img_url;\r\n    }\r\n\r\n    invalid_file(){\r\n        this.message_callback('Only JPEGs, PNGs, GIFs, BMPs, or WebP allowed');\r\n    }\r\n\r\n    get cropbox(){\r\n        let current = this.current_image;\r\n        return {\r\n            x: current.x + this.crop.x*this.zoom,\r\n            y: current.y + this.crop.y*this.zoom,\r\n            width: this.crop.width*this.zoom,\r\n            height: this.crop.height*this.zoom\r\n        };\r\n    }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}